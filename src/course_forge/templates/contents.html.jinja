<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ site_name }} - {{ course_name }}</title>
    <link rel="icon" href="/img/dark-favicon.svg" media="(prefers-color-scheme: light)">
    <link rel="icon" href="/img/light-favicon.svg" media="(prefers-color-scheme: dark)">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@400;600&family=Fira+Code&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/base.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <div class="contents-page">
        <header class="contents-header">
            <a href="{{ back_link_url }}" class="back-link">← {{ back_link_text }}</a>
            <div class="contents-ornament">❧</div>
            <h1 class="contents-title">{{ course_name }}</h1>
            {% if year %}
            <p class="contents-year">{{ year }}</p>
            {% endif %}
        </header>

        <main class="contents-main">
            <p class="contents-subtitle">Tabela de Conteúdos</p>

            <div class="parts-container {% if parts|length == 1 %}parts-container--single{% endif %}">
                {% for part in parts %}
                <div class="part-block {% if not part.title %}single-part{% endif %}" {% if part.roman
                    %}id="part-{{ part.roman }}" {% endif %}>
                    {% if part.title %}
                    <h3 class="part-title">
                        <span class="part-roman">{{ part.roman }}</span>
                        {{ part.title }}
                    </h3>
                    {% endif %}

                    <ol class="contents-list">
                        {% for chapter in part.chapters %}
                        <li class="contents-item">
                            <a href="{{ chapter.slug }}.html" class="contents-link">
                                <span class="contents-name">{{ chapter.name }}</span>
                            </a>
                        </li>
                        {% endfor %}
                    </ol>
                </div>
                {% endfor %}
            </div>

            {% if appendices %}
            <section class="contents-section appendices-section">
                <h2 class="section-title">{{ appendices_title or 'Apêndices' }}</h2>
                <ul class="contents-list appendices-list">
                    {% for appendix in appendices %}
                    <li class="contents-item">
                        <a href="{{ appendix.slug }}" class="contents-link">
                            <i data-lucide="paperclip" class="appendix-icon"></i>
                            <span class="contents-name">{{ appendix.name }}</span>
                            <span class="course-arrow">→</span>
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </section>

            {% endif %}
        </main>

        <footer class="footer">
            <p>© 2025 · <a href="#">{{ author }}</a></p>
        </footer>
    </div>

    <script src="/js/navigation.js"></script>
    <script src="/js/ui.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize Lucide icons
            CourseForgeUI.initIcons();

            const isSubcourse = {{ is_subcourse | tojson
        }};
        const courseName = {{ course_name | tojson }};

        // Store context if it's a main course
        CourseForgeNav.storeContext(courseName, window.location.href, isSubcourse);

        // Apply dynamic back link
        CourseForgeNav.applyDynamicBackLink(
            '.back-link',
            '{{ back_link_url }}',
            '{{ back_link_text }}',
            isSubcourse
        );
        });
    </script>
</body>

</html>